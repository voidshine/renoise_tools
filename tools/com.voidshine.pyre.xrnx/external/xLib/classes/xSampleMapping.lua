class'xSampleMapping'xSampleMapping.MIN_NOTE=0;xSampleMapping.MAX_NOTE=119;xSampleMapping.MIN_VELOCITY=0x00;xSampleMapping.MAX_VELOCITY=0x80;xSampleMapping.DEFAULT_LAYER=renoise.Instrument.LAYER_NOTE_ON;xSampleMapping.DEFAULT_BASENOTE=48;xSampleMapping.DEFAULT_VEL_TO_VOL=true;xSampleMapping.DEFAULT_KEY_TO_PITCH=true;function xSampleMapping:__init(...)local a=cLib.unpack_args(...)self.layer=a.layer or xSampleMapping.DEFAULT_LAYER;self.base_note=a.base_note or xSampleMapping.DEFAULT_BASENOTE;self.note_range=a.note_range or xSampleMapping.get_full_note_range()self.velocity_range=a.velocity_range or xSampleMapping.get_full_velocity_range()self.map_key_to_pitch=cReflection.as_boolean(a.map_key_to_pitch,true)self.map_velocity_to_volume=cReflection.as_boolean(a.map_velocity_to_volume,true)self.sample=a.sample;self.index=type(a)~="SampleMapping"and a.index end;function xSampleMapping:__tostring()return self.type.." layer:"..tostring(self.layer)..", base_note:"..tostring(self.base_note)..", map_velocity_to_volume:"..tostring(self.map_velocity_to_volume)..", map_key_to_pitch:"..tostring(self.map_key_to_pitch)..", note_range:"..tostring(self.note_range)..", velocity_range:"..tostring(self.velocity_range)..", sample:"..tostring(self.sample)..", index:"..tostring(self.index)end;function xSampleMapping.within_note_range(b,c)TRACE("xSampleMapping.within_note_range(note,mapping)",b,c)local d=c.note_range;return b>=d[1]and b<=d[2]end;function xSampleMapping.has_full_range(c)return xSampleMapping.has_full_note_range(c)and xSampleMapping.has_full_velocity_range(c)end;function xSampleMapping.get_full_note_range()return{xSampleMapping.MIN_NOTE,xSampleMapping.MAX_NOTE}end;function xSampleMapping.has_full_note_range(c)return c.note_range[1]==xSampleMapping.MIN_NOTE and c.note_range[2]==xSampleMapping.MAX_NOTE end;function xSampleMapping.get_full_velocity_range()return{xSampleMapping.MIN_VELOCITY,xSampleMapping.MAX_VELOCITY}end;function xSampleMapping.has_full_velocity_range(c)return c.velocity_range[1]==xSampleMapping.MIN_VELOCITY and c.velocity_range[2]==xSampleMapping.MAX_VELOCITY end;function xSampleMapping.get_memoized_key(c)return("%d.%d.%d.%d.%d"):format(c.layer,c.note_range[1],c.note_range[2],c.velocity_range[1],c.velocity_range[2])end;function xSampleMapping.get_memoized_key(c)return("%d.%d.%d.%d.%d"):format(c.layer,c.note_range[1],c.note_range[2],c.velocity_range[1],c.velocity_range[2])end