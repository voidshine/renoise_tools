cLib.require(_xlibroot.."xTrack")class'xColumns'function xColumns.previous_column()local a=rns.selected_track_index;local b=rns.tracks[a]local c=b.visible_note_columns;local d=b.visible_effect_columns;local e=c+d;local f=0;if rns.selected_note_column_index>0 then f=rns.selected_note_column_index-1 elseif rns.selected_effect_column_index>0 then f=c+rns.selected_effect_column_index-1 end;if f>=1 and f>c then rns.selected_effect_column_index=f-c elseif f>=1 then rns.selected_note_column_index=f else a=cLib.wrap_value(a-1,1,#rns.tracks)b=rns.tracks[a]c=b.visible_note_columns;d=b.visible_effect_columns;e=c+d;rns.selected_track_index=a;if d>0 then rns.selected_effect_column_index=d else rns.selected_note_column_index=c end end end;function xColumns.next_column()local a=rns.selected_track_index;local b=rns.tracks[a]local c=b.visible_note_columns;local d=b.visible_effect_columns;local e=c+d;local f=0;if rns.selected_note_column_index>0 then f=rns.selected_note_column_index+1 elseif rns.selected_effect_column_index>0 then f=c+rns.selected_effect_column_index+1 end;if f<=c then rns.selected_note_column_index=f elseif f<=e then rns.selected_effect_column_index=f-c else a=cLib.wrap_value(a+1,1,#rns.tracks)b=rns.tracks[a]c=b.visible_note_columns;rns.selected_track_index=a;if c>0 then rns.selected_note_column_index=1 else rns.selected_effect_column_index=1 end end end;function xColumns.next_note_column(g,h,i)TRACE("xColumns.next_note_column(wrap_pattern,wrap_track,track_index)",g,h,i)if not i then i=rns.selected_track_index end;local j=rns.tracks[i]local k=rns.selected_track_index==i;local l=rns.selected_note_column_index;if k then l=l+1;if l>j.visible_note_columns then l=1;if not h then xTrack.jump_to_next_sequencer_track(i,g)end end else rns.selected_track_index=i;l=1 end;rns.selected_note_column_index=l end;function xColumns.previous_note_column(g,h,i)TRACE("xColumns.previous_note_column(wrap_pattern,wrap_track,track_index)",i,h,g)if not i then i=rns.selected_track_index end;local j=rns.tracks[i]local k=rns.selected_track_index==i;local l=rns.selected_note_column_index;if k then print('sel')l=l-1;if l<1 then if not h then if xTrack.jump_to_previous_sequencer_track(i,g)then l=rns.selected_track.visible_note_columns end else l=j.visible_note_columns end end else print('one')rns.selected_track_index=i;l=1 end;if l<j.max_note_columns and l>0 then rns.selected_note_column_index=l end end;function xColumns.shift_note_columns(m,l,n,o,p)TRACE("xColumns.shift_note_columns(ptrack_or_phrase,col_idx,amount,line_start,line_end)",m,l,n,o,p)local q=m:lines_in_range(o,p)for r,s in ipairs(q)do for t,u in ripairs(s.note_columns)do if t-n>=l then u:copy_from(s.note_columns[t-n])end end end end